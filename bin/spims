#! /usr/bin/env python

import sys
import os
import Image

sys.path.append("../src/")

if __name__ == "__main__":
    import spims
    from optparse import OptionParser
    parser = OptionParser()
    parser.add_option("-p", "--pattern", dest="pattern", help="Image to search for.", metavar="PATTERN_FILE")
    parser.add_option("-s", "--source", dest="source", help="Image to search for", metavar="SOURCE_FILE")

    (options, args) = parser.parse_args()
    if options.pattern is None:
        parser.error('Pattern must be provided')
    if options.source is None:
        parser.error('Source must be provided')
    else: 
        for pattern_file in os.listdir(options.pattern):
            for source_file in os.listdir(options.source):
                pattern_img = options.pattern + pattern_file
                source_img = options.source + source_file
                pattern = spims.Img(pattern_img)
                source = spims.Img(source_img)
                match_coords = spims.match_rgb(pattern, source)
                spims.print_result(match_coords, pattern, source)
